{{- define "main" -}}
<div class="wrapper">
<p class="no-print">⬅ <a href="{{ .Parent.Permalink }}" class="link-more link-back">Retour à la liste des {{ .Parent.Title }}</a></p>
<h1>{{ .Title }} <small>{{ if .Params.tags }}{{ range .Params.tags }}pour <a href="/tags/{{ . }}">{{ . }}</a>{{ end }}{{ end }}</small></h1>
{{- partial "elements/content.html" .Content -}}
{{ $project :=  (index (split .Path "/") 1)}}
{{- $auditfile := (index $.Site.Data $project) -}}
{{- with $auditfile -}}
<h3>Scores</h3>
{{- partial "components/scores/performance" $project -}}
{{ $.Scratch.Set "allfile" slice }}
{{- range $key, $value := (index . "lighthouse")  -}}
  {{ $.Scratch.Add "allfile" $key }}
{{- end -}}
{{ $lastfile := (index (index . "lighthouse") (string (delimit (last 1 ($.Scratch.Get "allfile")) ""))) }}
<dl>
  {{- range $key, $value := (index $lastfile "audits") -}}
  {{- if and (not (eq (string .score) "1")) (not (eq (string .score) "null")) (.score) -}}
  <dt>{{ .title }}</dt>
  <dd>{{ index (split .description ".") 0 }}<br>
  => <small><strong>{{ .displayValue }}</strong></small>
  <dd>
  <ul>
    {{- range .details.items -}}
      {{- if and (not (eq .url "Unattributable")) .url -}}<li>{{ .url }}</li>{{- end -}}
    {{- end -}}
  </ul>
  {{- end -}}
  {{- end -}}
</dl>
</div>
{{- end -}}
{{- end -}}
{{- define "script" -}}
{{- end -}}
