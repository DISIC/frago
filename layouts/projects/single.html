{{- define "main" -}}
  <h1 class="text-center">{{ .Title }}</h1>
  {{- $project :=  replace (index (split .Path "/") 1) ".md" "" -}}
  {{- $pathimage := printf "./static/assets/images/%s/" $project }}
  <div class="wrapper text-center">
  <h2>Scores</h2>
  <h3>Performance</h3>
  {{ $auditfile := (index $.Site.Data.audits $project) }}
  {{ if $auditfile }}
    {{- range $key, $value := (index $auditfile "lighthouse")  -}}
    <div class="progress">
      <div></div>
      <div>
      <ul>
        <li class="counter text-center" data-name="Performance">Page chargée<br>{{ div (index (index (index (index (index (index . "audits") "metrics") "details") "items") 0) "largestContentfulPaint") 1000 }}s</li>
        <li class="counter text-center" data-name="SEO">Poids de la page<br>{{ div (index (index (index (index (index (index . "audits") "diagnostics") "details") "items") 0) "totalByteWeight") 1000 | lang.NumFmt 0 }}kb</li>
        <li class="counter text-center" data-name="Bonnes pratiques">Éléments sur la page<br>{{ (index (index (index . "audits") "dom-size") "numericValue") | lang.NumFmt 0 }}</li>
        <li class="counter text-center" data-name="Accessibilité">Nombre de requêtes<br>{{ (index (index (index (index (index (index . "audits") "diagnostics") "details") "items") 0) "numRequests") }}</li>
      </ul>
      </div>
    </div>
    {{- end -}}
    {{- range index (index $auditfile "accessibility") -}}
      {{ $.Scratch.Set "countererrorstotal" 0 }}
      {{ $.Scratch.Set "countererrorschecked" 0 }}
      {{ $.Scratch.Set "countererrorstypecode" 0 }}
      {{ $.Scratch.Set "countererrorstypevisual" 0 }}
      {{ $.Scratch.Set "countererrorstypestructure" 0 }}
      {{ $.Scratch.Set "countererrorstypetext" 0 }}
      {{- range .pages -}}
      {{- range $b := .blocks -}}
      {{- range .errors -}}
        {{ $.Scratch.Add "countererrorstotal" 1 }}
        {{ if .checked }}{{ $.Scratch.Add "countererrorschecked" 1 }}{{ end }}
      {{- end -}}
      {{- end -}}
      {{- end -}}
      <h3>Accessibilité</h3>
      <div class="progress">
      <ul>
      <li class="counter text-center d-inline-block">{{ $.Scratch.Get "countererrorstotal" }}<br>Au total</li>
      <li class="counter text-center d-inline-block good">{{ $.Scratch.Get "countererrorschecked" }}<br>Corrigées</li>
      </ul>
      </div>
    {{- end -}}
  {{- end -}}
  </div>
  {{- partial "elements/phases.html" (dict "context" . "type" "dark") -}}
  {{- partial "list.html" (dict "context" . "section" "meetings") -}}
  {{- partial "list.html" (dict "context" . "section" "actions" "type" "dark") -}}
  {{- partial "list.html" (dict "context" . "section" "studies") -}}
  <hr class="divider">
  {{- .Content -}}
{{- end -}}
